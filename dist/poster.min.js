/*! @overbool/poster v1.0.1 | (c) 2018 Overbool | https://github.com/overbool/poster */
"use strict";var poster=function(){var d=!1,u=768;function S(t,e,i){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"none",n=document.createElement(t);return n.setAttribute(e,i),n.style.display=o,n.width=u,n}function m(t,e,i){var o=t.getContext("2d");t.height=parseInt(e.font.match(/\d+/),10)+20,o.font=e.font,o.fillStyle=e.color;for(var n=0,l=0,r=!(o.textBaseline="top"),a=0;a<i.length;a++)if((n+=o.measureText(i[a]).width)>t.width-60){r=!0,l=a;break}var h=30;r&&(i=i.substring(0,l),h=t.width/2-n/2),d&&(o.strokeStyle="#6fda92",o.strokeRect(0,0,t.width,t.height)),"center"===e.position?(o.textAlign="center",o.fillText(i,t.width/2,0)):"left"===e.position?o.fillText(i,h,0):(o.textAlign="right",o.fillText(i,t.width-h,0))}function I(t,e,i){var o=t.getContext("2d"),n=parseInt(e.font.match(/\d+/),10);d&&(o.strokeStyle="#6fda92",o.strokeRect(0,0,t.width,t.height)),o.font=e.font,o.fillStyle=e.color,o.textBaseline="top";var l=0;l=(o.textAlign="center")===e.position?t.width/2:"left"===e.position?(o.textAlign="left",60):(o.textAlign="right",t.width-60);for(var r=0,a=0,h=0,c=0;c<i.length;c++)(r+=o.measureText(i[c]).width)>t.width-120&&(o.fillText(i.substring(a,c),l,h),h+=n*e.lineHeight,r=0,a=c),c===i.length-1&&o.fillText(i.substring(a,c+1),l,h)}return{init:function(o){var n=document.querySelector(o.selector);n.style.border="1px solid #f0f0f0";var l=S("div","id","wrapper"),r=S("canvas","id","canvas","block"),a=S("canvas","id","author"),h=S("canvas","id","day"),c=S("canvas","id","date"),d=S("canvas","id","title"),g=S("canvas","id","content"),s=S("canvas","id","logo"),f=S("canvas","id","description"),t=S("canvas","id","qrcode"),p=S("canvas","id","qrcode-desc");!function(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];i.forEach(function(t){e.appendChild(t)})}(l,r,a,h,c,d,g,s,f,t,p),n.appendChild(l),m(a,{font:"italic 45px Arial",color:"rgba(255, 255, 255, 1)",position:"left"},o.author);var e=new Date;m(h,{font:"italic bold 70px Arial",color:"rgba(255, 255, 255, 1)",position:"right"},e.getDate()),m(c,{font:"italic 30px Arial",color:"rgba(255, 255, 255, 1)",position:"right"},e.getFullYear()+" / "+(e.getMonth()+1));var i={font:"bold 50px Arial",color:"rgba(66, 66, 66, 1)",position:"center"};i.font=o.titleStyle&&o.titleStyle.font||i.font,i.color=o.titleStyle&&o.titleStyle.color||i.color,i.position=o.titleStyle&&o.titleStyle.position||i.position,m(d,i,o.title);var w={font:"24px Arial",lineHeight:1.5,position:"center",color:"rgba(88, 88, 88, 1)"};w.font=o.contentStyle&&o.contentStyle.font||w.font,w.color=o.contentStyle&&o.contentStyle.color||w.color,w.lineHeight=o.contentStyle&&o.contentStyle.lineHeight||w.lineHeight,w.position=o.contentStyle&&o.contentStyle.position||w.position,I(g,w,o.content);var v={font:"bold 40px Roboto Slab",position:"center",color:"rgba(0, 0, 25, 1)"};v.color=o.logoStyle&&o.logoStyle.color||v.color,s.width*=.7,m(s,v,o.logo),f.width*=.7777777,I(f,{font:"24px Arial",color:"rgba(180, 180, 180, 1)",lineHeight:1.1,position:"center"},o.description),p.width*=.7,m(p,{font:"28px Arial",color:"rgba(88, 88, 88, 1)",lineHeight:1.1,position:"center"},o.qrcodeDesc);var y=new Image,x=new Image;window.addEventListener("load",function(){r.width=u,r.height=1168,y.src=o.banner,y.onload=b,x.src=o.qrcode,x.onload=function(){}},!1);var b=function(){var t=r.getContext("2d");t.fillStyle="rgba(255, 255, 255, 1)",t.fillRect(0,0,r.width,r.height),t.drawImage(y,0,0,r.width,r.height/2),t.drawImage(a,15,15),t.drawImage(h,0,r.height/2-120),t.drawImage(c,0,r.height/2-50),t.drawImage(d,0,r.height/2+75),t.drawImage(g,0,r.height/2+185),t.drawImage(s,0,r.height-s.height-25),t.drawImage(f,0,r.height-f.height+20),t.drawImage(p,0,r.height-f.height-25),t.drawImage(x,.7*r.width+20,r.height-f.height-30,.2*r.width,.2*r.width),t.strokeStyle="rgba(122, 122, 122, 0.5)",t.setLineDash([5,6]),t.moveTo(0,r.height/2+365),t.lineTo(768,r.height/2+365),t.stroke();var e=new Image;e.src=r.toDataURL("image/png");var i=o.radio||.7;e.width=u*i,e.height=1168*i,t.clearRect(0,0,r.width,r.height),r.style.display="none",n.appendChild(e),n.removeChild(l),o.callback&&o.callback(n)}}}}();